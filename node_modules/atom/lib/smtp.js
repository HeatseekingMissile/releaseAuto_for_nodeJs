var fs = require('fs')
  , mailer = require('nodemailer');

module.exports = function (config) {
    mailer.SMTP = {
        host: config.host || '127.0.0.1'
      , port: config.port || 25
      , user: config.user || ''
      , pass: config.pass || ''
      , use_authentication: config.auth || false
    };

    return function (to, subject, body, callback) {
        mailer.send_mail({
            sender  : config.from || ''
          , to      : to
          , subject : subject
          , html    : body
        }, callback || function () {});
    };
};

